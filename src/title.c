#include "misc.h"
#include "video.h"
#include "audio.h"
#include "game.h"

#define MINER       80 * WIDTH + 29 * 8

static u8       titlePixels[2048 + 256] =
{
      5, 255, 255, 255, 255, 255, 224,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 255, 255, 255, 255,   0,   0,   0,   0,   0,   0,
      7, 255, 255, 255, 255, 255, 248,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   1, 124, 224,   7,  62, 128,   0,   0,   0,   0,   0,
      3, 255, 255, 255, 255, 255, 208,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   1, 187,  95, 250, 221, 128,   0,   0,   0,   0,   0,
      1, 255, 255, 255, 255, 255, 224,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   3, 215, 191, 253, 235, 192,   0,   0,   0,   0,   0,
      6, 255, 255, 255, 255, 255, 228,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   3, 239, 255, 255, 247, 192,   0,   0,   0,   0,   0,
     11, 255, 255, 255, 255, 255, 208,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   7, 255, 255, 255, 255, 224,   0,   0,   0,   0,   0,
      5, 255, 255, 255, 255, 255, 180,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   7, 255, 255, 255, 255, 224,   0,   0,   0,   0,   0,
     42, 255, 255, 255, 255, 255, 248,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  15, 255, 255, 255, 255, 240,   0,   0,   0,   0,   0,
     59, 255, 255, 255, 253, 255, 224,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  15,  63,   0,   0, 240, 240,   0,   0,   0,   0,   0,
     22, 255, 207, 255, 241, 255, 200,   0,   0,   0,   0,   0,   1, 240,   0,   0,   0,   0,   0,   0,   0,   7, 255,   0,   0, 255, 224,   0,   0,   0,   0,   0,
     29, 255, 225, 255, 199, 255, 180,   0,   0,   0,   0,   0,   7, 248,   0,   0,   0,   0,   0,   0,   0,   0, 255, 126, 126, 223,   0,   0,   0,   0,   0,   0,
     31, 255, 226, 127,  39, 255, 246,   0,   0,   0,   0,   0,  15, 252,   0,   0,   0,   0,   0,   0,   0,   0,   7, 126, 126,  24,   0,   0,   0,   0,   0,   0,
      5, 255, 248, 190,  15, 207, 200,   0,   0,   0,   0,   0,  30,  59, 176,   0,   0,   0,   0,   0,   0,   0, 223, 126, 126, 251,   0,   0,   0,   0,   0,   0,
      3, 255, 252,  29,  63, 255, 208,   0,   0,   0,   0,   0,  29, 215, 216,   0,   0,   0,   0,   0,   0,   0, 223, 126, 126, 251,   0,   0,   0,   0,   0,   0,
      6, 255, 254,   0, 127, 255, 184,   0,   0,   0,   0,   0,  11, 239, 232,   0,   0,   0,   0,   0,   0,   0,  24, 126, 126, 224,   0,   0,   0,   0,   0,   0,
      3, 255, 255,   4, 255, 255, 100,   0,   0,   0,   0,   0,   7, 223, 236,   0,   0,   0,   0,   0,   0,   0, 255,   0,   0, 255,   0,   0,   0,   0,   0,   0,
      3, 249,  63,   1, 255, 255,   0,   0,   7, 224,   0,   0,  15, 223, 220,   0,   0,   0,   0,   0,   0,   0, 255,   0,   0, 255,  34,  34,   0,  48,  12,   0,
      5, 240, 207,  10, 255, 255,   0,   0, 127, 254,   0,   0,  15, 239, 120,   0,   0,   0,  24,   0,  10,  48,   1, 126, 126,  28, 119, 119,   0,  80,  12,   0,
      5, 239,   3,  43, 255, 208,   0,   0, 127, 254,   0,   0,  31, 255, 151, 128,   0,   0, 124,  56,  46, 124, 223, 126, 126, 223, 119, 119,   0,  80,   4,   3,
     23, 255, 208,  93, 255, 248,   0,   0, 127, 254,   0,   0,  31, 255, 239,  92, 112,   0, 126,  56, 174, 124, 223, 126, 126, 223, 255, 255,   0, 144,  12,  62,
     29, 255, 224,  85, 255, 192,   0,   0,  63, 252,   0,   0,  14, 127, 238, 222, 248,   0, 236, 252, 238, 238,   7, 126, 126, 128, 255, 255,   0, 160,   8,  16,
     31, 255, 248,  85, 255, 128,   1, 128,  63, 252,   1, 128,  15, 191, 238, 222, 248, 102, 254, 238, 102, 254, 255, 126, 126, 255, 119, 119,   1,  32,  24, 252,
     10, 255, 253,  85, 255,   0,   7, 128,  63, 252,   1, 224,   7, 223, 207, 111, 120, 238, 126, 126, 116, 252, 255,   0,   0, 255, 119, 119,  63, 255, 255, 255,
      7, 255, 254,  93, 255,   0,  31, 192,  63, 252,   3, 248,   3, 143, 135, 191, 240, 238, 108, 124,  36,  56,  12,   0,   0, 252, 119, 119, 255, 255, 227, 255,
      0, 255, 159, 107, 243,   0,  63, 192,  31, 248,   3, 252,   0,   0,   0,   0,   0,  68,   7,  48,  52,  22, 223, 127, 247, 255, 119, 119,  60, 207, 255,  60,
      0, 127,  15, 170, 244,   0, 127, 224,  31, 248,   7, 254,   0,   0,   0,   0,   0, 104,  24, 160,  20,  19, 223, 127, 247, 255, 119, 119, 126, 255, 255, 126,
      0,  62,   7, 170, 192,   0, 255, 224,  31, 248,   7, 255,   0,   0,   0,   0,   0,  18,  14, 224,  28,  26, 128,  32,   0,   0, 119, 119, 239, 255, 255, 239,
      0,  20,   2, 171, 192,   1, 255, 240,  31, 248,  15, 255, 128,   0,   0,   0,   0,  62,  15, 220,  24,  78, 251, 239, 190, 251, 119, 119, 251, 255, 255, 251,
      0,   0,   0, 109, 128,   1, 255, 240,  15, 240,  15, 255, 128,   0,   0,   0,  66, 104, 134, 142,   8, 108, 251, 239, 190, 251, 119, 119, 223, 207, 255, 223,
      0,   0,   0, 117,   0,   3, 255, 248,  15, 240,  31, 255, 192,   0,   0,   1,  42,  12, 160, 198,   8, 116,   3,   0,   0, 192, 119, 119, 247, 255, 255, 247,
      0,   0,   0,  85,   0,   3, 255, 248,  15, 240,  31, 255, 192,   0,   0,   0, 164,   4,  64, 192,  12,   4, 223, 253, 247, 223, 119, 119, 126, 127, 254, 126,
      0,   0,   0,  85,   0,   7, 255, 252,  15, 240,  63, 255, 224,   0,   0,  18, 255, 255, 224, 192, 255,   7, 223, 255, 247, 255, 119, 119,  60,   0,   0,  60,
      0,   0,   0, 117,   0,   7, 255, 252,   7, 224,  63, 255, 224,   0,   0,  73, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
      0,   0,   0, 173,   0,   1, 255, 254,   7, 224, 127, 255, 128,   0,   0,  63, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
      0,   0,   0, 174,   0,   0, 127, 254,   0,   0, 127, 254,   0,   0,   0, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
      0,   0,   0, 106,   0,   0,  31, 255,   0,   0, 255, 248,   0,   0,  15, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
      0,   0,   0,  90,   0,   0,   7, 255,   3, 192, 255, 224,   0,   0,  63, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
      0,   0,   0,  86,   0,   0,   1, 254,  31, 248, 127, 128,   0,   0, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
      0,   0,   0,  85,   0,   0,   0, 124, 127, 254,  62,   0,   0,  15, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
      0,   0,   0, 117,   0,   0,   0,  24, 255, 255,  24,   0,   0, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
      0,   0,   0, 181,   0,   0,   0,   1, 255, 255, 128,   0,   0,  31, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
      0,   0,   0, 173,   0, 112,   0,   3, 255, 255, 192,   0,  14,  15, 255, 253, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 249, 255, 255, 255, 255, 255,
      0,   0,   6, 173,  48, 127,   0,   3, 255, 255, 192,   0, 254,   7, 255, 237, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 244, 255, 255, 219, 255, 255,
      0,   0,  15, 174, 248, 127, 240,   7, 255, 255, 224,  15, 254,   7, 255, 235, 255, 255, 255, 255, 255, 255, 255, 255, 239, 255, 224, 255, 255, 231, 255, 255,
      0,   0, 127, 118, 252, 127, 255,   7, 255, 255, 224, 255, 254,   3, 255, 247, 255, 255, 255, 255, 255, 255, 255, 255, 183, 255, 249, 255, 255, 247, 255, 255,
      0,   1, 255,  85, 252, 255, 255, 199, 255, 255, 227, 255, 255,   1, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 215, 255, 243, 255, 255, 255, 255, 255,
      0,  15, 255,  69, 254, 255, 255, 207, 255, 255, 243, 255, 255,   1, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 239, 255, 231, 255, 255, 255, 255, 255,
      0,  31, 255,  33, 255, 255, 255, 207, 255, 255, 243, 255, 255,   0, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 228,  23, 255, 255, 255, 255,
      0,  63, 254,   0, 127, 128,   0,   0,   7, 192,   0,   0,   0,   0, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 241,  71, 255, 255, 255, 255,
      1, 255, 248,   8, 127, 207,   0,   0,   1, 240,   0,   0,   0,   0, 255, 255, 237, 255, 255, 255, 255, 255, 255, 255, 255, 255, 250, 143, 255, 255, 255, 255,
      3, 255, 240, 199,  63, 255, 192,   0,   7, 224,   0,   0,  15, 192, 255, 255, 243, 255, 255,  63, 252, 255, 255, 255, 255, 255, 249,   7, 255, 255, 255, 255,
     15, 255, 243, 247, 255, 255, 225, 128,   3, 240,   0,   1, 255, 252, 255, 255, 247, 255, 252,   0,   0,   0,  31, 255, 255, 255, 248,  15, 255, 255, 255, 255,
     63, 255, 255, 255, 255, 255, 255, 224,   1, 128,   0,  63, 255, 255,  62, 255, 255, 255, 253,   0,   0, 221, 223, 255, 255, 255, 252,  31, 255, 255, 255, 255,
    255, 255, 255, 255, 255, 255, 255, 240,  15, 192,   3, 255, 255, 255, 193, 255, 255, 255, 240,  31, 248,   0,  31, 255, 255, 255, 255, 255, 255, 255, 255, 255,
    255, 255, 255, 255, 255, 255, 255, 248,   3, 240,  31, 255, 255, 255, 255, 255, 255, 255, 247,   7, 224, 119, 127, 255, 255, 255, 255, 255, 255, 255, 255, 255,
    255, 255, 255, 255, 255, 255, 255, 254,   1, 192, 127, 255, 255, 255, 255, 255, 255, 255, 192,  33, 132,   0,   1, 255, 255, 255, 255, 255, 255, 255, 252,   0,
    255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 221,  58,  92, 221, 221, 255, 255, 255, 255, 255, 255, 255, 253, 221,
      7, 255,   7, 255,   7, 255, 240, 127, 255, 255, 255, 255, 255, 240, 112, 127, 255, 240,   0,  60, 188,   0,   0, 127, 240,   7, 255, 240, 127, 240, 112,   0,
    119, 255, 119, 255, 119, 255, 247, 127, 255, 255, 255, 255, 255, 247, 119, 127, 255, 247, 119,  33,  12, 119, 119, 127, 247, 119, 255, 247, 127, 247, 119, 119,
      0,  28,   0,  28,   7, 252,  16,  28,  28,   1, 192,   0,  31, 192,   0,  65, 252,   0,   0,   7, 192,   0,   0,   0,   0,   0,   1, 192,  31, 240,   0,   0,
    221, 221, 221, 221, 223, 253, 221, 221, 221, 221, 221, 221, 223, 221, 221, 221, 253, 221, 221,  31, 240, 221, 221, 221, 221, 221, 221, 221, 223, 253, 221, 221,
      0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
    119, 119, 119, 119, 119, 119, 119, 119, 119, 119, 119, 119, 119, 119, 119, 119, 119, 119, 119,   0,   0, 119, 119, 119, 119, 119, 119, 119, 119, 119, 119, 119,
      0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  63, 252,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,

    255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
    170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170,
     68,  68,  68,  68,  68,  68,  68,  68,  68,  68,  68,  68,  68,  68,  68,  68,  68,  68,  68,  68,  68,  68,  68,  68,  68,  68,  68,  68,  68,  68,  68,  68,
     17,  17,  17,  17,  17,  17,  17,  17,  17,  17,  17,  17,  17,  17,  17,  17,  17,  17,  17,  17,  17,  17,  17,  17,  17,  17,  17,  17,  17,  17,  17,  17,
      0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
      0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
      0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
      0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0
};

static u8       titleColour[256 + 32] =
{
    0x5d, 0xcd, 0xcd, 0xcd, 0x4d, 0x4d, 0x5d, 0x50, 0x50, 0x50, 0x50, 0x50, 0x57, 0x57, 0x57, 0x57, 0x57, 0x50, 0x50, 0x50, 0x50, 0x5e, 0xfe, 0xfe, 0xfe, 0xfe, 0x5e, 0x50, 0x50, 0x50, 0x50, 0x50,
    0x5d, 0xcd, 0xfd, 0xfd, 0xfd, 0xcd, 0x5d, 0x50, 0x50, 0x57, 0x50, 0x50, 0x57, 0x57, 0x57, 0x57, 0x57, 0x50, 0x50, 0x50, 0x50, 0x5e, 0x87, 0xb9, 0xb9, 0x87, 0x5e, 0x50, 0x50, 0x52, 0x52, 0x50,
    0x5d, 0xfd, 0xfd, 0xfe, 0x4d, 0x5d, 0x56, 0x56, 0x56, 0x56, 0x56, 0x56, 0x57, 0x57, 0x57, 0x57, 0x57, 0x53, 0x52, 0x57, 0x56, 0x51, 0x87, 0xb9, 0xb9, 0x87, 0x57, 0x57, 0x52, 0x52, 0x52, 0x52,
    0x50, 0x5d, 0x5d, 0xfe, 0x5d, 0x56, 0x56, 0x56, 0x56, 0x56, 0x56, 0x56, 0x56, 0x50, 0x50, 0x5c, 0x5c, 0x5c, 0x5c, 0x5c, 0x5c, 0x5c, 0x87, 0x87, 0x87, 0x87, 0x57, 0x57, 0x50, 0x52, 0x52, 0x50,
    0x50, 0x50, 0x50, 0xfe, 0x50, 0x56, 0x56, 0x56, 0x56, 0x56, 0x56, 0x56, 0x56, 0x5c, 0x5c, 0x5c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c,
    0x50, 0x5c, 0x5c, 0xfe, 0x5c, 0x56, 0x56, 0x56, 0x56, 0x56, 0x56, 0x56, 0x56, 0x7c, 0x0c, 0x4c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x4c, 0x0c, 0x7c, 0x7c, 0x0c, 0x4c, 0x0c, 0x0c,
    0x1c, 0x1c, 0xfc, 0xfc, 0xfc, 0x1c, 0x1c, 0x1c, 0x17, 0x17, 0x1c, 0x1c, 0x1c, 0x7c, 0x4c, 0x0c, 0x4c, 0x0c, 0x6c, 0xfc, 0xfc, 0x6c, 0x6c, 0x0c, 0x0c, 0x0c, 0x7c, 0x7c, 0x0c, 0x0c, 0x6c, 0x6c,
    0x6c, 0x6c, 0x6c, 0x6c, 0x6c, 0x6c, 0x6c, 0x6c, 0x6c, 0x6c, 0x6c, 0x6c, 0x6c, 0x6c, 0x6c, 0x6c, 0x6c, 0x6c, 0x6c, 0xfc, 0xfc, 0x6c, 0x6c, 0x6c, 0x6c, 0x6c, 0x6c, 0x6c, 0x6c, 0x6c, 0x6c, 0x6c,

    0xa6, 0xa6, 0xa6, 0xa6, 0xa6, 0xa6, 0xa6, 0xa6, 0xa6, 0xa6, 0xa6, 0xa6, 0xa6, 0xa6, 0xa6, 0xa6, 0xa6, 0xa6, 0xa6, 0xa6, 0xa6, 0xa6, 0xa6, 0xa6, 0xa6, 0xa6, 0xa6, 0xa6, 0xa6, 0xa6, 0xa6, 0xa6
};

#define TEXT_MM     "\x1\x0\x2\x2" "M" "\x2\x6" "A" "\x2\x4" "N" "\x2\x5" "I" "\x2\x3" "C " "\x2\x5" "M" "\x2\x3" "I" "\x2\x2" "N" "\x2\x6" "E" "\x2\x4" "R   "
#define TEXT_KEYS   "\x2\x5" "Cursor Keys = Left & Right   " "\x2\x6" "Space = Jump   " "\x2\x3" "Pause/Tab = Pause   " "\x2\x4" "Alt = Tune On/Off" TEXT_32
#define TEXT_GUIDE  "\x2\x7" "Guide " "\x2\x5" "M" "\x2\x3" "i" "\x2\x2" "n" "\x2\x6" "e" "\x2\x4" "r" "\x2\x7" " Willy through 20 " "\x2\x2" "lethal " "\x2\x7" "caverns ..."
#define TEXT_32     "                                "

static char     textTicker[2][307] =
{
    TEXT_MM "\x2\x7" "(C) Bug-Byte Ltd. 1983   By Matthew Smith" TEXT_32 TEXT_KEYS TEXT_GUIDE,
    TEXT_MM "\x2\x7" "(C) Software Projects Ltd. 1983   By Matthew Smith" TEXT_32 TEXT_KEYS TEXT_GUIDE
};

static int      gameVersion = 0;
static int      textPos, textEnd[2] = {248 * -8, 257 * -8};

void Title_ScreenCopy()
{
    Video_CopyBytes(titlePixels);
    Video_CopyColour(titleColour, 0, 256 + 32);
}

static void DoStartGame()
{
    Video_PixelFill(128 * WIDTH, 16 * WIDTH, 0x7);

    Video_Write(137 * WIDTH + 3, "\x1\x7\x2\x1" "A I R");
    Video_PixelFill(144 * WIDTH, 48 * WIDTH, 0x0);
    Video_WriteLarge(SCORE, 4, "\x1\x0\x2\x6" "High .....0        " "\x2\xe" "Score .....0");
    Game_GameReset();

    // we're calling an action from within an action
    // but that's ok ;-)
    Game_Action();
}

static void DoTitleTicker()
{
    textPos -= 2;

    if (textPos < textEnd[gameVersion])
    {
        gameDemo = 1;
        Action = DoStartGame;
    }

    Miner_IncSeq();
}

static void DoTitleDrawer()
{
    Video_WriteLarge(160 * WIDTH, textPos, textTicker[gameVersion]);

    Miner_DrawSeqSprite(MINER, 0xa, 0x7);
}

static void DoTitleInit()
{
    Title_ScreenCopy();
    Video_PixelFill(72 * WIDTH, 72 * WIDTH, 0xa);
    Video_PixelFill(144 * WIDTH, 48 * WIDTH, 0x0);

    Video_WriteLarge(82 * WIDTH, 0, "\x1\xa\x2\x7\x3\x4\x5\x6\x7\x8\x9\xa\xb\xc\xd\xe\xf\x10\x11\x12\x13\x14\x15\x16");

    Video_Write(80 * WIDTH + 21 * 8, "\x2\x0" "Starring...");
    Video_Write(88 * WIDTH + 22 * 8, "\x2\x6" "Miner Willy");

    Video_WriteLarge(104 * WIDTH, 6 * 8, "\x2\x0" "PRESS " "\x2\x6" "ENTER" "\x2\x0" " TO START");

    Video_WriteLarge(KEYBOARD, 4, "\x1\x0\x2\x7\x1a\x1b\x1c\x1a\x1b\x1b\x1c\x1a\x1b\x1c\x1a\x1b\x1b\x1c\x1a\x1b\x1c\x1a\x1b\x1b\x1c\x1a\x1b\x1c\x1a\x1b\x1b\x1c\x1a\x1b\x1c");

    textPos = WIDTH;

    Miner_SetSeq(7, 8);
    Miner_DrawSeqSprite(MINER, 0xa, 0x7);

    Audio_Music(MUS_TITLE, MUS_PLAY);

    Ticker = DoNothing;
}

static void DoTitleResponder()
{
    if (gameInput == KEY_ENTER)
    {
        gameVersion = System_IsKey(KEY_LSHIFT);
        Robots_Version(gameVersion);

        gameDemo = 0;
        Action = DoStartGame;
    }
    else if (gameInput == KEY_ESCAPE)
    {
        DoQuit();
    }
}

static void DoTitleAction()
{
    if (audioMusicPlaying)
    {
        return;
    }

    Ticker = DoTitleTicker;
    Drawer = DoTitleDrawer;

    Action = DoNothing;
}

void Title_Action()
{
    Responder = DoTitleResponder;
    Ticker = DoTitleInit;
    Drawer = Audio_Drawer;

    Action = DoTitleAction;
}
